!function(){"use strict";class e{constructor(e){let{name:t,link:s,userId:r,_id:i,ownerId:n,isLiked:o,handleImageClick:a,handleDeleteClick:l,handleLikeClick:d,cardSelector:c}=e;this._name=t,this._link=s,this._userId=r,this._cardId=i,this._ownerId=n,this._isLiked=o,this._handleImageClick=a,this._handleDeleteClick=l,this._handleLikeClick=d,this._cardSelector=c,this._cardElement=this._getCardTemplate(),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardTitleElement=this._cardElement.querySelector(".card__title"),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._cardDeleteButton=this._cardElement.querySelector(".card__delete-button")}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteClick(this)))}_renderLikes(){this._isLiked?this._cardLikeButton.classList.add("card__like-button_active"):this._cardLikeButton.classList.remove("card__like-button_active")}setLikes(e){this._isLiked=e,this._renderLikes()}deleteCard(){this._cardElement.remove(),this._cardElement=null}_getCardTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardTitleElement.textContent=this._name,this._setEventListeners(),this._renderLikes(),this._cardElement}}class t{constructor(e,t){this._settings=e,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}hideModalInputError(){this._inputElements.forEach((e=>{e.classList.remove(this._inputErrorClass),this._form.querySelector(`#${e.id}-error`).classList.remove(this._errorClass)}))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}resetValidation(){this._toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}resetButtonState(){this._toggleButtonState()}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const s=(document.querySelector("#card-template").content.querySelector(".card"),document.querySelector("#edit-profile-form"),document.querySelector("#add-card-form")),r=(document.querySelector(".content__list"),document.querySelector(".profile__avatar-button")),i=document.querySelector("#edit-profile-button"),n=(document.querySelector("#close-profile-button"),document.querySelector("#add-card-button")),o=(s.querySelector("#create-card-button"),document.querySelector("#close-add-card-button"),document.querySelector("#close-preview-button"),document.querySelector(".profile__image"),document.querySelector(".profile__name"),document.querySelector(".profile__description"),document.querySelector("#preview-image-caption"),document.querySelector("#modal-preview-image"),document.querySelector("#profile-name-input")),a=document.querySelector("#profile-description-input");document.querySelector("#card-title-input"),document.querySelector("#card-link-input");class l{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this.renderer=r,this._selector=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this.renderer(e)}))}addItem(e){this._selector.prepend(e)}}class d{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class c extends d{constructor(e,t){super(e),this._popupForm=this._popup.querySelector(".modal__form"),this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._handleFormSubmit=t,this._submitButton=this._popup.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}close(){super.close(),this._popupForm.reset()}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const{apiToken:u,apiUrl:h}={apiToken:"911f3778-21cb-4f5c-ab83-db0550cf1beb",apiUrl:"https://around-api.en.tripleten-services.com/v1"};let _=null;const m=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponse(e){if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}editUserInfo(e){let{name:t,description:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._handleResponse)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.link})}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponse)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}}({baseUrl:h,headers:{authorization:u,"Content-Type":"application/json"}}),p=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,about:this._descriptionElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=s}setAvatar(e){this._avatarElement.src=e,this._avatarElement.alt=this._nameElement.textContent}}(".profile__name",".profile__description",".profile__image"),v=e=>{b.setSubmitAction((()=>{b.setButtonText(!0),m.deleteCard(e._cardId).then((()=>{e.deleteCard(),b.close()})).catch((e=>{console.error(e)})).finally((()=>b.setButtonText(!1)))})),b.open()},E=e=>{e._isLiked?m.dislikeCard(e._cardId).then((()=>{e.setLikes(!1)})).catch((e=>{console.error(e)})):m.likeCard(e._cardId).then((()=>{e.setLikes(!0)})).catch((e=>{console.error(e)}))},b=new class extends d{constructor(e){super(e),this._form=this._popup.querySelector(".modal__form"),this._submitButton=this._popup.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){this._form.addEventListener("submit",(()=>{this._handleFormSubmit()})),super.setEventListeners()}}("#delete-modal");b.setEventListeners(),Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;p.setUserInfo({name:t.name,about:t.about}),p.setAvatar(t.avatar),_=new l({items:s,renderer:e=>{_.addItem(k(e,null))}},".content__list"),_.renderItems()})).catch((e=>{console.error(e)}));const S={};var f;f={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(f.formSelector)).forEach((e=>{const s=new t(f,e),r=e.getAttribute("name");S[r]=s,s.enableValidation()})),i.addEventListener("click",(()=>{const e=p.getUserInfo();o.value=e.name,a.value=e.about,g.open(),S["profile-form"].resetValidation()}));const k=(t,s)=>{let{name:r,link:i,_id:n,ownerId:o,isLiked:a}=t;return new e({name:r,link:i,userId:s,_id:n,ownerId:o,isLiked:a,handleImageClick:y,handleDeleteClick:v,handleLikeClick:E,cardSelector:"#card-template"}).getView()},y=e=>{let{name:t,link:s}=e;C.open({name:t,link:s})},L=new c("#edit-avatar-modal",(e=>{L.setButtonText(!0),m.updateAvatar(e).then((e=>{p.setAvatar(e.avatar),L.close()})).catch((e=>{console.error(e)})).finally((()=>L.setButtonText()))}));L.setEventListeners();const C=new class extends d{constructor(e){super(e),this._previewImage=this._popup.querySelector(".modal__preview-image"),this._previewCaption=this._popup.querySelector(".modal__caption")}open(e){let{link:t,name:s}=e;this._previewImage.src=t,this._previewImage.alt=s,this._previewCaption.textContent=s,super.open()}}("#preview-image-modal");C.setEventListeners();const I=new c("#add-card-modal",(e=>{I.setButtonText(!0),m.createCard(e).then((e=>{_.addItem(k(e,null)),I.close()})).catch((e=>{console.error(e)})).finally((()=>I.setButtonText(!1)))}));I.setEventListeners();const g=new c("#edit-profile-modal",(e=>{g.setButtonText(!0),m.editUserInfo(e).then((e=>{p.setUserInfo({name:e.name,about:e.about}),g.close()})).catch((e=>{console.error(e)})).finally((()=>g.setButtonText(!1)))}));g.setEventListeners(),r.addEventListener("click",(()=>{L.open(),S["avatar-form"].resetValidation()})),n.addEventListener("click",(()=>{I.open(),S["card-form"].resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUJoSCxpQkFBaUIsSUFHaEVVLEVBQWMzRCxpQkFBaUIsU0FBUyxLQUN0Q2tMLEVBQVV0RyxPQUNWcUYsRUpuS2tCLGFJbUt5QmhILGlCQUFpQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3Ioe1xyXG4gICAgbmFtZSxcclxuICAgIGxpbmssXHJcbiAgICB1c2VySWQsXHJcbiAgICBfaWQsXHJcbiAgICBvd25lcklkLFxyXG4gICAgaXNMaWtlZCxcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGljayxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fY2FyZElkID0gX2lkO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IG93bmVySWQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIC8vIGdldCB0aGUgY2FyZCB2aWV3XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldENhcmRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGVFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uID1cclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBsaWtlIGJ1dHRvblxyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xyXG4gICAgfSk7XHJcbiAgICAvLyBkZWxldGUgYnV0dG9uXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRMaWtlcyhpc0xpa2VkKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBfZ2V0Q2FyZFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAvLyBzZXQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgIC8vIHJldHVybiBjYXJkXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbSA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW0udGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbS50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxyXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBoaWRlTW9kYWxJbnB1dEVycm9yKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgdGhpcy5fZm9ybVxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcclxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNldEJ1dHRvblN0YXRlKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICB0aXRsZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICB0aXRsZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICB0aXRsZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIHRpdGxlOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgYXBpSW5mbyA9IHtcclxuICBhcGlUb2tlbjogXCI5MTFmMzc3OC0yMWNiLTRmNWMtYWI4My1kYjA1NTBjZjFiZWJcIixcclxuICBhcGlVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgYXZhdGFyTW9kYWxTZWxlY3RvcjogXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcclxuICBhdmF0YXJGb3JtU2VsZWN0b3I6IFwiYXZhdGFyLWZvcm1cIixcclxuXHJcbiAgdXNlckF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG4gIHVzZXJOYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICB1c2VyRGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuXHJcbiAgaW1hZ2VNb2RhbFNlbGVjdG9yOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIsXHJcblxyXG4gIGNhcmRMaXN0U2VsZWN0b3I6IFwiLmNvbnRlbnRfX2xpc3RcIixcclxuICBjYXJkU2VsZWN0b3I6IFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICBjYXJkTW9kYWxTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcclxuICBjYXJkRm9ybVNlbGVjdG9yOiBcImNhcmQtZm9ybVwiLFxyXG5cclxuICBwcm9maWxlTW9kYWxTZWxlY3RvcjogXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIsXHJcbiAgcHJvZmlsZUZvcm1TZWxlY3RvcjogXCJwcm9maWxlLWZvcm1cIixcclxuXHJcbiAgY29uZmlybWF0aW9uTW9kYWxTZWxlY3RvcjogXCIjZGVsZXRlLW1vZGFsXCIsXHJcbn07XHJcblxyXG4vLyBFbGVtZW50c1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKVxyXG4gIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcclxuXHJcbi8vIEZvcm1zXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIik7XHJcblxyXG4vLyBXcmFwcGVyc1xyXG5leHBvcnQgY29uc3QgY2FyZExpc3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250ZW50X19saXN0XCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gXCIjYWRkLWNhcmQtbW9kYWxcIjtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiO1xyXG5cclxuLy8gQnV0dG9uc1xyXG5leHBvcnQgY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUNsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNjbG9zZS1wcm9maWxlLWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkU3VibWl0QnV0dG9uID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcclxuICBcIiNjcmVhdGUtY2FyZC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgYWRkQ2FyZENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNjbG9zZS1hZGQtY2FyZC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2Nsb3NlLXByZXZpZXctYnV0dG9uXCJcclxuKTtcclxuXHJcbi8vIG90aGVyIERPTSBub2Rlc1xyXG5cclxuZXhwb3J0IGNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcmV2aWV3LWltYWdlLWNhcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcmV2aWV3LWltYWdlXCIpO1xyXG5cclxuLy8gRm9ybSBkYXRhXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10aXRsZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtbGluay1pbnB1dFwiKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMucmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAvLyBhZGRzIHRvIHRoZSBET01cbiAgICB0aGlzLl9zZWxlY3Rvci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpIHx8XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihzZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdCwgYnV0dG9uVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChzdWJtaXQpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAvLyBDcmVhdGUgYW4gZW1wdHkgb2JqZWN0XHJcbiAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XHJcbiAgICAvLyBBZGQgdGhlIHZhbHVlcyBvZiB0aGUgZmllbGRzIHRvIHRoaXMgb2JqZWN0XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICAvLyBSZXR1cm4gdGhlIHZhbHVlcyBvYmplY3RcclxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgLy8gYWRkIHN1Ym1pdCBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7IC8vIGFkZCBpbXBvcnQgb2YgdGhlIG1haW4gc3R5bGVzaGVldHMgZmlsZVxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHtcbiAgYXZhdGFyQnV0dG9uLFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVOYW1lSW5wdXQsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxuICBhZGRDYXJkQnV0dG9uLFxuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgc2VsZWN0b3JzLFxuICBhcGlJbmZvLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbi8vIEluaXRpYWwgc3RhcnQtdXBcbmNvbnN0IHsgYXBpVG9rZW4sIGFwaVVybCB9ID0gYXBpSW5mbztcblxubGV0IHVzZXJJZCA9IG51bGw7XG5sZXQgc2VjdGlvbiA9IG51bGw7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBhcGlVcmwsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBhcGlUb2tlbixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgc2VsZWN0b3JzLnVzZXJOYW1lU2VsZWN0b3IsXG4gIHNlbGVjdG9ycy51c2VyRGVzY3JpcHRpb25TZWxlY3RvcixcbiAgc2VsZWN0b3JzLnVzZXJBdmF0YXJTZWxlY3RvclxuKTtcblxuY29uc3QgaGFuZGxlRGVsZXRlQ2xpY2sgPSAoY2FyZCkgPT4ge1xuICBjb25maXJtYXRpb25Nb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGNvbmZpcm1hdGlvbk1vZGFsLnNldEJ1dHRvblRleHQodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9jYXJkSWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiBjb25maXJtYXRpb25Nb2RhbC5zZXRCdXR0b25UZXh0KGZhbHNlKSk7XG4gIH0pO1xuICBjb25maXJtYXRpb25Nb2RhbC5vcGVuKCk7XG59O1xuXG5jb25zdCBoYW5kbGVMaWtlQ2xpY2sgPSAoY2FyZCkgPT4ge1xuICBpZiAoY2FyZC5faXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLmRpc2xpa2VDYXJkKGNhcmQuX2NhcmRJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5zZXRMaWtlcyhmYWxzZSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZC5fY2FyZElkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLnNldExpa2VzKHRydWUpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG59O1xuXG5jb25zdCBjb25maXJtYXRpb25Nb2RhbCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXG4gIHNlbGVjdG9ycy5jb25maXJtYXRpb25Nb2RhbFNlbGVjdG9yXG4pO1xuY29uZmlybWF0aW9uTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxuICAudGhlbigoW2RhdGEsIGNhcmRzXSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgIH0pO1xuICAgIHVzZXJJbmZvLnNldEF2YXRhcihkYXRhLmF2YXRhcik7XG5cbiAgICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgIHNlY3Rpb24uYWRkSXRlbShyZW5kZXJDYXJkKGNhcmREYXRhLCB1c2VySWQpKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBzZWxlY3RvcnMuY2FyZExpc3RTZWxlY3RvclxuICAgICk7XG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfSk7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25TZXR0aW5ncy5mb3JtU2VsZWN0b3IpXG4gICk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtKSA9PiB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbSk7XG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25TZXR0aW5ncyk7XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuXG4gIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gaW5mby5hYm91dDtcblxuICBwcm9maWxlTW9kYWwub3BlbigpO1xuICBmb3JtVmFsaWRhdG9yc1tcInByb2ZpbGUtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcbn0pO1xuXG5jb25zdCByZW5kZXJDYXJkID0gKHsgbmFtZSwgbGluaywgX2lkLCBvd25lcklkLCBpc0xpa2VkIH0sIHVzZXJJZCkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xuICAgIG5hbWUsXG4gICAgbGluayxcbiAgICB1c2VySWQsXG4gICAgX2lkLFxuICAgIG93bmVySWQsXG4gICAgaXNMaWtlZCxcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGljayxcbiAgICBjYXJkU2VsZWN0b3I6IHNlbGVjdG9ycy5jYXJkU2VsZWN0b3IsXG4gIH0pO1xuXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn07XG5cbmNvbnN0IGhhbmRsZUltYWdlQ2xpY2sgPSAoeyBuYW1lLCBsaW5rIH0pID0+IHtcbiAgaW1hZ2VNb2RhbC5vcGVuKHsgbmFtZSwgbGluayB9KTtcbn07XG5cbmNvbnN0IGF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHNlbGVjdG9ycy5hdmF0YXJNb2RhbFNlbGVjdG9yLFxuICAoYXZhdGFyRGF0YSkgPT4ge1xuICAgIGF2YXRhck1vZGFsLnNldEJ1dHRvblRleHQodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAudXBkYXRlQXZhdGFyKGF2YXRhckRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRBdmF0YXIoZGF0YS5hdmF0YXIpO1xuICAgICAgICBhdmF0YXJNb2RhbC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiBhdmF0YXJNb2RhbC5zZXRCdXR0b25UZXh0KCkpO1xuICB9XG4pO1xuYXZhdGFyTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMuaW1hZ2VNb2RhbFNlbGVjdG9yKTtcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgY2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmNhcmRNb2RhbFNlbGVjdG9yLCAoY2FyZERhdGEpID0+IHtcbiAgY2FyZE1vZGFsLnNldEJ1dHRvblRleHQodHJ1ZSk7XG4gIGFwaVxuICAgIC5jcmVhdGVDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW0ocmVuZGVyQ2FyZChkYXRhLCB1c2VySWQpKTtcbiAgICAgIGNhcmRNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IGNhcmRNb2RhbC5zZXRCdXR0b25UZXh0KGZhbHNlKSk7XG59KTtcbmNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwcm9maWxlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgc2VsZWN0b3JzLnByb2ZpbGVNb2RhbFNlbGVjdG9yLFxuICAocHJvZmlsZURhdGEpID0+IHtcbiAgICBwcm9maWxlTW9kYWwuc2V0QnV0dG9uVGV4dCh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5lZGl0VXNlckluZm8ocHJvZmlsZURhdGEpXG4gICAgICAudGhlbigocHJvZmlsZURhdGEpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICAgIG5hbWU6IHByb2ZpbGVEYXRhLm5hbWUsXG4gICAgICAgICAgYWJvdXQ6IHByb2ZpbGVEYXRhLmFib3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgcHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHByb2ZpbGVNb2RhbC5zZXRCdXR0b25UZXh0KGZhbHNlKSk7XG4gIH1cbik7XG5wcm9maWxlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhck1vZGFsLm9wZW4oKTtcbiAgZm9ybVZhbGlkYXRvcnNbc2VsZWN0b3JzLmF2YXRhckZvcm1TZWxlY3Rvcl0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjYXJkTW9kYWwub3BlbigpO1xuICBmb3JtVmFsaWRhdG9yc1tzZWxlY3RvcnMuY2FyZEZvcm1TZWxlY3Rvcl0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGRhdGEpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAvLyByZXR1cm5zIGFuIG9iamVjdCB3aXRoIGluZm8gb24gdGhlIHVzZXJcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgLy8gdGFrZXMgbmV3IHVzZXIgaW5mbyBhbmQgYWRkcyBpdCB0byB0aGUgcGFnZVxyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXQsIGJ1dHRvblRleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoc3VibWl0KSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGJ1dHRvblRleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gY2FsbGJhY2s7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoIHNlbGVjdG9yICk7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCIpO1xyXG4gICAgdGhpcy5fcHJldmlld0NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IGxpbmssIG5hbWUgfSkge1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3ByZXZpZXdDYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJuYW1lIiwibGluayIsInVzZXJJZCIsIl9pZCIsIm93bmVySWQiLCJpc0xpa2VkIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiY2FyZFNlbGVjdG9yIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfdXNlcklkIiwiX2NhcmRJZCIsIl9vd25lcklkIiwiX2lzTGlrZWQiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfY2FyZFNlbGVjdG9yIiwiX2NhcmRFbGVtZW50IiwiX2dldENhcmRUZW1wbGF0ZSIsIl9jYXJkSW1hZ2VFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIl9jYXJkVGl0bGVFbGVtZW50IiwiX2NhcmRMaWtlQnV0dG9uIiwiX2NhcmREZWxldGVCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX3JlbmRlckxpa2VzIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic2V0TGlrZXMiLCJkZWxldGVDYXJkIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtIiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfZXJyb3JNZXNzYWdlRWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJoaWRlTW9kYWxJbnB1dEVycm9yIiwiZm9yRWFjaCIsIl9kaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRFbGVtIiwicmVzZXRCdXR0b25TdGF0ZSIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJhZGRDYXJkRm9ybSIsImF2YXRhckJ1dHRvbiIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsIlNlY3Rpb24iLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfc2VsZWN0b3IiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2lucHV0TGlzdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJyZXNldCIsInNldEJ1dHRvblRleHQiLCJzdWJtaXQiLCJidXR0b25UZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2dldElucHV0VmFsdWVzIiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwiYXBpVG9rZW4iLCJhcGlVcmwiLCJzZWN0aW9uIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJkZXNjcmlwdGlvbiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJ1cGRhdGVBdmF0YXIiLCJkYXRhIiwiYXZhdGFyIiwiZ2V0SW5pdGlhbENhcmRzIiwiY3JlYXRlQ2FyZCIsInRpdGxlIiwiY2FyZElkIiwibGlrZUNhcmQiLCJkaXNsaWtlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwiY2FyZCIsImNvbmZpcm1hdGlvbk1vZGFsIiwic2V0U3VibWl0QWN0aW9uIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwiY2FsbGJhY2siLCJhbGwiLCJjYXJkcyIsImNhcmREYXRhIiwicmVuZGVyQ2FyZCIsImZvcm1WYWxpZGF0b3JzIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwiZm9ybUVsZW0iLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImluZm8iLCJwcm9maWxlTW9kYWwiLCJfcmVmMyIsImltYWdlTW9kYWwiLCJhdmF0YXJNb2RhbCIsImF2YXRhckRhdGEiLCJfcHJldmlld0ltYWdlIiwiX3ByZXZpZXdDYXB0aW9uIiwiY2FyZE1vZGFsIiwicHJvZmlsZURhdGEiXSwic291cmNlUm9vdCI6IiJ9